2025-04-30 18:19:45,220 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-04-30 18:19:45,227 - INFO - User authenticated: None, Plant: None
2025-04-30 18:19:47,136 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-04-30 18:19:47,136 - INFO - Connecting to GLOBAL Snowflake domain
2025-04-30 18:19:47,136 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-04-30 18:19:48,592 - INFO - Snowflake connection initialized
2025-04-30 18:19:50,430 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-04-30 18:19:50,688 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-04-30 18:19:50,980 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-04-30 18:19:51,048 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-04-30 18:19:51,048 - INFO - Connecting to GLOBAL Snowflake domain
2025-04-30 18:19:51,048 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-04-30 18:19:51,430 - INFO - Snowflake connection initialized
2025-04-30 18:19:55,631 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-04-30 18:19:55,633 - INFO - closed
2025-04-30 18:19:55,697 - INFO - No async queries seem to be running, deleting session
2025-04-30 18:19:55,835 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-04-30 18:19:55,835 - INFO - Connecting to GLOBAL Snowflake domain
2025-04-30 18:19:55,835 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-04-30 18:19:56,125 - INFO - Snowflake connection initialized
2025-04-30 18:19:59,965 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-04-30 18:19:59,970 - INFO - closed
2025-04-30 18:20:00,054 - INFO - No async queries seem to be running, deleting session
2025-04-30 18:20:00,185 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-04-30 18:20:00,185 - INFO - Connecting to GLOBAL Snowflake domain
2025-04-30 18:20:00,185 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-04-30 18:20:00,607 - INFO - Snowflake connection initialized
2025-04-30 18:21:03,172 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-04-30 18:21:03,175 - INFO - closed
2025-04-30 18:21:03,244 - INFO - No async queries seem to be running, deleting session
2025-05-01 10:50:13,810 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-05-01 10:50:13,810 - INFO - User authenticated: None, Plant: None
2025-05-01 10:50:14,853 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 10:50:14,853 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 10:50:14,853 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 10:50:15,783 - INFO - Snowflake connection initialized
2025-05-01 10:50:17,301 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 10:50:17,565 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 10:50:17,773 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 10:50:17,836 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 10:50:17,843 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 10:50:17,843 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 10:50:18,162 - INFO - Snowflake connection initialized
2025-05-01 10:50:21,810 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 10:50:21,811 - INFO - closed
2025-05-01 10:50:21,860 - INFO - No async queries seem to be running, deleting session
2025-05-01 10:50:21,991 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 10:50:21,991 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 10:50:21,998 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 10:50:22,255 - INFO - Snowflake connection initialized
2025-05-01 10:50:25,841 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 10:50:25,841 - INFO - closed
2025-05-01 10:50:25,904 - INFO - No async queries seem to be running, deleting session
2025-05-01 10:50:26,015 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 10:50:26,015 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 10:50:26,015 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 10:50:26,251 - INFO - Snowflake connection initialized
2025-05-01 10:51:24,184 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 10:51:24,191 - INFO - closed
2025-05-01 10:51:24,249 - INFO - No async queries seem to be running, deleting session
2025-05-01 10:51:41,695 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 10:51:41,719 - INFO - Inferred intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The query pertains to the reason for availability loss during the day shift, which relates to shift-level OEE performance data and breakdown data that provide insights into the causes of availability issues.'}
2025-05-01 10:51:41,720 - INFO - User query: give me the reason of availability loss increases during day shift
, Intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The query pertains to the reason for availability loss during the day shift, which relates to shift-level OEE performance data and breakdown data that provide insights into the causes of availability issues.'}
2025-05-01 10:51:42,306 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-05-01 10:51:42,313 - INFO - Generated 1 embeddings
2025-05-01 10:51:46,378 - INFO - Retrieved 3 relevant contexts for query: give me the reason of availability loss increases ...
2025-05-01 10:51:54,007 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 10:51:54,014 - INFO - RAG response for query 'give me the reason of availability loss increases during day shift
': To understand the increase in availability loss during the day shift, we first need to analyze the b...
2025-05-01 10:51:54,281 - INFO - Executed and cached query: SELECT 
    ob.MAIN as Breakdown_Category,
    ob.CATEGORY as Breakdown_Type,
    ob.RESON as Reason_1,
    ob.RESON2 as Reason_2,
    ob.RESON3 as Reason_3,
    ob.VALUE as Loss_Value,
    ob.PERC as Loss_Percentage
FROM 
    OEEBREAKDOWNAI ob
INNER JOIN 
    OEESHIFTWISE_AI oew ON ob.PUID = oew.PUID 
                          AND ob.SHIFTSTARTTIME = oew.SHIFTSTARTTIME 
                          AND ob.SHIFTENDTIME = oew.SHIFTENDTIME
INNER JOIN
    MACHINE_ACCESS_INFO_AI ma ON oew.PUID = ma.PUID
WHERE 
    ma.USER_CODE = 'None' 
    AND ma.PLANTCODE = 'None'
    AND oew.SHIFTDESC = 'DAY'
ORDER BY 
    ob.VALUE DESC;
2025-05-01 11:01:20,042 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-05-01 11:01:20,042 - INFO - User authenticated: None, Plant: None
2025-05-01 11:01:21,684 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 11:01:21,947 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 11:01:22,169 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 11:01:22,225 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:01:22,225 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:01:22,225 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:01:22,628 - INFO - Snowflake connection initialized
2025-05-01 11:01:26,429 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 11:01:26,429 - INFO - closed
2025-05-01 11:01:26,492 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:01:26,611 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:01:26,611 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:01:26,611 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:01:26,880 - INFO - Snowflake connection initialized
2025-05-01 11:01:30,737 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 11:01:30,737 - INFO - closed
2025-05-01 11:01:30,793 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:01:30,910 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:01:30,910 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:01:30,910 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:01:31,174 - INFO - Snowflake connection initialized
2025-05-01 11:02:28,344 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 11:02:28,344 - INFO - closed
2025-05-01 11:02:28,408 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:05:05,358 - INFO - User query: give me the reason of availability loss increases during day shift
, Intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The query pertains to the reason for availability loss during the day shift, which relates to shift-level OEE performance data and breakdown data that provide insights into the causes of availability issues.'}
2025-05-01 11:05:09,567 - INFO - Retrieved 3 relevant contexts for query: give me the reason of availability loss increases ...
2025-05-01 11:05:18,980 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:05:18,980 - INFO - RAG response for query 'give me the reason of availability loss increases during day shift
': Availability loss during the day shift could increase due to a variety of operational factors, inclu...
2025-05-01 11:06:03,031 - INFO - User query: give me the reason of availability loss increases during day shift
, Intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The query pertains to the reason for availability loss during the day shift, which relates to shift-level OEE performance data and breakdown data that provide insights into the causes of availability issues.'}
2025-05-01 11:06:07,260 - INFO - Retrieved 3 relevant contexts for query: give me the reason of availability loss increases ...
2025-05-01 11:06:17,685 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:06:17,687 - INFO - RAG response for query 'give me the reason of availability loss increases during day shift
': To investigate why availability loss increases during the day shift, we need to analyze the availabi...
2025-05-01 11:06:18,685 - INFO - Executed and cached query: SELECT 
    OEESHIFTWISE_AI.SHIFTDESC,
    SUM(CASE WHEN OEESHIFTWISE_AI.AVAILABILITYRATE < 100 THEN 100 - OEESHIFTWISE_AI.AVAILABILITYRATE END) AS AvailabilityLoss,
    COUNT(*) AS TotalShifts
FROM 
    O3_AI_DB.O3_AI_DB_SCHEMA.OEESHIFTWISE_AI
INNER JOIN 
    O3_AI_DB.O3_AI_DB_SCHEMA.MACHINE_ACCESS_INFO_AI 
ON 
    OEESHIFTWISE_AI.PUID = MACHINE_ACCESS_INFO_AI.PUID
WHERE 
    MACHINE_ACCESS_INFO_AI.USER_CODE = 'None' 
    AND MACHINE_ACCESS_INFO_AI.PLANTCODE = 'None'
    AND OEESHIFTWISE_AI.SHIFTDESC = 'DAY'
GROUP BY 
    OEESHIFTWISE_AI.SHIFTDESC;
2025-05-01 11:07:23,832 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-05-01 11:07:23,832 - INFO - User authenticated: None, Plant: None
2025-05-01 11:07:24,648 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 11:07:24,919 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 11:07:25,149 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 11:07:25,203 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:07:25,203 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:07:25,203 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:07:26,120 - INFO - Snowflake connection initialized
2025-05-01 11:07:29,863 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 11:07:29,863 - INFO - closed
2025-05-01 11:07:29,926 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:07:30,037 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:07:30,037 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:07:30,037 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:07:30,277 - INFO - Snowflake connection initialized
2025-05-01 11:07:35,136 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 11:07:35,137 - INFO - closed
2025-05-01 11:07:35,194 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:07:35,291 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:07:35,291 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:07:35,291 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:07:35,680 - INFO - Snowflake connection initialized
2025-05-01 11:08:23,923 - INFO - closed
2025-05-01 11:08:23,982 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:08:24,358 - INFO - closed
2025-05-01 11:08:24,358 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:11:16,289 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-05-01 11:11:16,289 - INFO - User authenticated: None, Plant: None
2025-05-01 11:11:16,289 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:11:16,289 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:11:16,289 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:11:16,791 - INFO - Snowflake connection initialized
2025-05-01 11:11:18,441 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 11:11:18,697 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 11:11:18,920 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 11:11:18,975 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:11:18,975 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:11:18,975 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:11:19,669 - INFO - Snowflake connection initialized
2025-05-01 11:11:23,443 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 11:11:23,443 - INFO - closed
2025-05-01 11:11:23,512 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:11:23,637 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:11:23,637 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:11:23,637 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:11:23,957 - INFO - Snowflake connection initialized
2025-05-01 11:11:27,987 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 11:11:27,987 - INFO - closed
2025-05-01 11:11:28,050 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:11:28,160 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:11:28,160 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:11:28,167 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:11:28,479 - INFO - Snowflake connection initialized
2025-05-01 11:12:25,296 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 11:12:25,296 - INFO - closed
2025-05-01 11:12:25,352 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:13:02,296 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:13:02,314 - INFO - Inferred intent: {'tables': ['OEEBREAKDOWNAI'], 'reason': "The query 'give me breakdown of low oee' specifically pertains to the breakdown and downtime data, which is covered by the OEEBREAKDOWNAI table. The other tables are not directly related to the request for a breakdown of OEE."}
2025-05-01 11:13:02,314 - INFO - User query: give me breakdown of low oee, Intent: {'tables': ['OEEBREAKDOWNAI'], 'reason': "The query 'give me breakdown of low oee' specifically pertains to the breakdown and downtime data, which is covered by the OEEBREAKDOWNAI table. The other tables are not directly related to the request for a breakdown of OEE."}
2025-05-01 11:13:03,439 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-05-01 11:13:03,452 - INFO - Generated 1 embeddings
2025-05-01 11:13:06,218 - INFO - Retrieved 3 relevant contexts for query: give me breakdown of low oee...
2025-05-01 11:13:15,311 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:13:15,330 - INFO - RAG response for query 'give me breakdown of low oee': To retrieve the breakdown of low OEE, we can define "low OEE" as OEE values below a specific thresho...
2025-05-01 11:13:15,761 - INFO - Executed and cached query: SELECT
    OEEBREAKDOWNAI.MAIN,
    OEEBREAKDOWNAI.CATEGORY,
    OEEBREAKDOWNAI.RESON,
    OEEBREAKDOWNAI.VALUE,
    OEESHIFTWISE_AI.MACHINE,
    OEESHIFTWISE_AI.LINE,
    OEESHIFTWISE_AI.DATE,
    OEESHIFTWISE_AI.OEE,
    OEESHIFTWISE_AI.AVAILABILITYRATE,
    OEESHIFTWISE_AI.PERFORMANCERATE,
    OEESHIFTWISE_AI.QUALITYRATE
FROM
    OEEBREAKDOWNAI
INNER JOIN
    OEESHIFTWISE_AI ON OEEBREAKDOWNAI.PUID = OEESHIFTWISE_AI.PUID
WHERE
    OEEBREAKDOWNAI.SHIFTSTARTTIME = OEESHIFTWISE_AI.SHIFTSTARTTIME
    AND OEEBREAKDOWNAI.SHIFTENDTIME = OEESHIFTWISE_AI.SHIFTENDTIME
    AND OEESHIFTWISE_AI.OEE < 50
    AND OEESHIFTWISE_AI.PUID IN (
        SELECT PUID
        FROM MACHINE_ACCESS_INFO_AI
        WHERE USER_CODE = 'None' AND PLANTCODE = 'None'
    )
ORDER BY OEESHIFTWISE_AI.DATE;
2025-05-01 11:24:02,142 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-05-01 11:24:02,142 - INFO - User authenticated: None, Plant: None
2025-05-01 11:24:03,302 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 11:24:03,518 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 11:24:03,747 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 11:24:03,802 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:24:03,802 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:24:03,802 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:24:04,107 - INFO - Snowflake connection initialized
2025-05-01 11:24:07,985 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 11:24:07,985 - INFO - closed
2025-05-01 11:24:08,048 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:24:08,151 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:24:08,151 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:24:08,151 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:24:08,735 - INFO - Snowflake connection initialized
2025-05-01 11:24:12,418 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 11:24:12,418 - INFO - closed
2025-05-01 11:24:12,473 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:24:12,577 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:24:12,577 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:24:12,577 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:24:12,848 - INFO - Snowflake connection initialized
2025-05-01 11:25:09,941 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 11:25:09,941 - INFO - closed
2025-05-01 11:25:10,003 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:25:25,073 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:25:25,079 - INFO - Inferred intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The query pertains to availability loss during the day shift, which relates to shift-level performance data available in OEESHIFTWISE_AI. Additionally, the query seeks to understand reasons for this loss, which can be found in the OEEBREAKDOWNAI table that contains breakdown and downtime data.'}
2025-05-01 11:25:25,079 - INFO - User query: give me the reason of availability loss increases during day shift, Intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The query pertains to availability loss during the day shift, which relates to shift-level performance data available in OEESHIFTWISE_AI. Additionally, the query seeks to understand reasons for this loss, which can be found in the OEEBREAKDOWNAI table that contains breakdown and downtime data.'}
2025-05-01 11:25:25,904 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-05-01 11:25:25,904 - INFO - Generated 1 embeddings
2025-05-01 11:25:30,055 - INFO - Retrieved 3 relevant contexts for query: give me the reason of availability loss increases ...
2025-05-01 11:25:39,241 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:25:39,269 - INFO - RAG response for query 'give me the reason of availability loss increases during day shift': It appears that you are trying to understand the reasons behind the increase in availability loss du...
2025-05-01 11:25:39,569 - INFO - Executed and cached query: SELECT 
    OEEBREAKDOWNAI.RESON AS Reason,
    SUM(OEEBREAKDOWNAI.VALUE) AS TotalLoss
FROM 
    OEESHIFTWISE_AI
JOIN 
    OEEBREAKDOWNAI ON OEESHIFTWISE_AI.PUID = OEEBREAKDOWNAI.PUID 
    AND OEESHIFTWISE_AI.SHIFTSTARTTIME = OEEBREAKDOWNAI.SHIFTSTARTTIME 
    AND OEESHIFTWISE_AI.SHIFTENDTIME = OEEBREAKDOWNAI.SHIFTENDTIME
JOIN 
    machine_access_info_ai ON OEESHIFTWISE_AI.PUID = machine_access_info_ai.PUID
WHERE 
    OEESHIFTWISE_AI.SHIFTDESC = 'DAY' 
    AND machine_access_info_ai.USER_CODE = 'None' 
    AND machine_access_info_ai.PLANTCODE = 'None'
GROUP BY 
    OEEBREAKDOWNAI.RESON
ORDER BY 
    TotalLoss DESC;
2025-05-01 11:27:50,401 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:27:50,411 - INFO - Inferred intent: {'tables': ['OEESHIFTWISE_AI'], 'reason': 'The query asks for the maximum OEE (Overall Equipment Effectiveness) specifically for April 2025, which pertains to shift-level performance data related to OEE. The other tables cover breakdown and downtime data, and machine access information, which are not directly relevant to the OEE metric in the context of the query.'}
2025-05-01 11:27:50,412 - INFO - User query: what is max oee in april 2025, Intent: {'tables': ['OEESHIFTWISE_AI'], 'reason': 'The query asks for the maximum OEE (Overall Equipment Effectiveness) specifically for April 2025, which pertains to shift-level performance data related to OEE. The other tables cover breakdown and downtime data, and machine access information, which are not directly relevant to the OEE metric in the context of the query.'}
2025-05-01 11:27:51,126 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-05-01 11:27:51,128 - INFO - Generated 1 embeddings
2025-05-01 11:27:55,220 - INFO - Retrieved 3 relevant contexts for query: what is max oee in april 2025...
2025-05-01 11:27:56,776 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:27:56,790 - INFO - RAG response for query 'what is max oee in april 2025': You don't have access to this data. Please verify your credentials....
2025-05-01 11:32:13,008 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:32:13,010 - INFO - Inferred intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The query asks for the maximum OEE (Overall Equipment Effectiveness) for March 2025, which relates to shift-level performance data stored in OEESHIFTWISE_AI. Additionally, breakdown or downtime reasons could be relevant for understanding OEE, thus OEEBREAKDOWNAI is also pertinent.'}
2025-05-01 11:32:13,011 - INFO - User query: what is max oee in march 2025, Intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The query asks for the maximum OEE (Overall Equipment Effectiveness) for March 2025, which relates to shift-level performance data stored in OEESHIFTWISE_AI. Additionally, breakdown or downtime reasons could be relevant for understanding OEE, thus OEEBREAKDOWNAI is also pertinent.'}
2025-05-01 11:32:14,137 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-05-01 11:32:14,141 - INFO - Generated 1 embeddings
2025-05-01 11:32:17,874 - INFO - Retrieved 3 relevant contexts for query: what is max oee in march 2025...
2025-05-01 11:32:19,180 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:32:19,185 - INFO - RAG response for query 'what is max oee in march 2025': You don't have access to this data. Please verify your credentials....
2025-05-01 11:48:34,138 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-05-01 11:48:34,139 - INFO - User authenticated: None, Plant: None
2025-05-01 11:48:35,311 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 11:48:35,598 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 11:48:35,876 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 11:48:35,930 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:48:35,930 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:48:35,930 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:48:36,313 - INFO - Snowflake connection initialized
2025-05-01 11:48:40,123 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 11:48:40,124 - INFO - closed
2025-05-01 11:48:40,185 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:48:40,312 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:48:40,312 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:48:40,313 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:48:40,599 - INFO - Snowflake connection initialized
2025-05-01 11:48:45,097 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 11:48:45,097 - INFO - closed
2025-05-01 11:48:45,145 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:48:45,257 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 11:48:45,257 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 11:48:45,257 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 11:48:45,527 - INFO - Snowflake connection initialized
2025-05-01 11:49:54,319 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 11:49:54,319 - INFO - closed
2025-05-01 11:49:54,374 - INFO - No async queries seem to be running, deleting session
2025-05-01 11:49:56,436 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:49:56,438 - INFO - Inferred intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The user query requests OEE (Overall Equipment Effectiveness) data for February 2024, which relates primarily to shift-level performance metrics found in OEESHIFTWISE_AI and may require breakdown data for comprehensive insights, which is found in OEEBREAKDOWNAI.'}
2025-05-01 11:49:56,438 - INFO - User query: give me oee for feb 2024, Intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The user query requests OEE (Overall Equipment Effectiveness) data for February 2024, which relates primarily to shift-level performance metrics found in OEESHIFTWISE_AI and may require breakdown data for comprehensive insights, which is found in OEEBREAKDOWNAI.'}
2025-05-01 11:49:57,049 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-05-01 11:49:57,055 - INFO - Generated 1 embeddings
2025-05-01 11:49:59,864 - INFO - Retrieved 3 relevant contexts for query: give me oee for feb 2024...
2025-05-01 11:50:00,927 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:50:00,929 - INFO - RAG response for query 'give me oee for feb 2024': You don't have access to this data. Please verify your credentials....
2025-05-01 11:51:38,349 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:51:38,365 - INFO - Inferred intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The query requests the maximum Overall Equipment Effectiveness (OEE) for February 2025, which pertains to performance data typically found in the OEESHIFTWISE_AI table. The OEE may also involve breakdown-related data, found in the OEEBREAKDOWNAI table, especially if analyzing factors that could affect OEE. The MACHINE_ACCESS_INFO_AI table is not relevant to the OEE query.'}
2025-05-01 11:51:38,366 - INFO - User query: give me max oee for feb 2025, Intent: {'tables': ['OEESHIFTWISE_AI', 'OEEBREAKDOWNAI'], 'reason': 'The query requests the maximum Overall Equipment Effectiveness (OEE) for February 2025, which pertains to performance data typically found in the OEESHIFTWISE_AI table. The OEE may also involve breakdown-related data, found in the OEEBREAKDOWNAI table, especially if analyzing factors that could affect OEE. The MACHINE_ACCESS_INFO_AI table is not relevant to the OEE query.'}
2025-05-01 11:51:39,462 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-05-01 11:51:39,471 - INFO - Generated 1 embeddings
2025-05-01 11:51:43,267 - INFO - Retrieved 3 relevant contexts for query: give me max oee for feb 2025...
2025-05-01 11:51:44,346 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 11:51:44,349 - INFO - RAG response for query 'give me max oee for feb 2025': You don't have access to this data. Please verify your credentials....
2025-05-01 12:13:28,348 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-05-01 12:13:28,349 - INFO - User authenticated: None, Plant: None
2025-05-01 12:13:30,630 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 12:13:30,859 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 12:13:31,081 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 12:13:31,124 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:13:31,124 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:13:31,124 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:13:31,426 - INFO - Snowflake connection initialized
2025-05-01 12:13:35,740 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 12:13:35,740 - INFO - closed
2025-05-01 12:13:35,858 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:13:35,979 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:13:35,979 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:13:35,979 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:13:36,242 - INFO - Snowflake connection initialized
2025-05-01 12:13:39,961 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 12:13:39,961 - INFO - closed
2025-05-01 12:13:40,013 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:13:40,107 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:13:40,107 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:13:40,107 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:13:40,361 - INFO - Snowflake connection initialized
2025-05-01 12:14:37,883 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 12:14:37,884 - INFO - closed
2025-05-01 12:14:37,936 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:14:43,303 - INFO - closed
2025-05-01 12:14:43,305 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:15:20,943 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-05-01 12:15:20,943 - INFO - User authenticated: None, Plant: None
2025-05-01 12:15:22,035 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:15:22,035 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:15:22,035 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:15:22,646 - INFO - Snowflake connection initialized
2025-05-01 12:15:24,269 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 12:15:24,526 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 12:15:24,762 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 12:15:24,817 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:15:24,817 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:15:24,817 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:15:25,116 - INFO - Snowflake connection initialized
2025-05-01 12:15:28,786 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 12:15:28,786 - INFO - closed
2025-05-01 12:15:28,848 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:15:28,963 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:15:28,963 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:15:28,963 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:15:29,272 - INFO - Snowflake connection initialized
2025-05-01 12:15:33,488 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 12:15:33,488 - INFO - closed
2025-05-01 12:15:33,549 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:15:33,657 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:15:33,657 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:15:33,657 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:15:33,908 - INFO - Snowflake connection initialized
2025-05-01 12:16:31,886 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 12:16:31,902 - INFO - closed
2025-05-01 12:16:31,954 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:19:45,762 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 12:19:45,774 - INFO - Inferred intent: {'tables': ['OEESHIFTWISE_AI'], 'reason': "The query asks for the 'best oee', which pertains to overall equipment effectiveness (OEE) at a shift level, making the OEESHIFTWISE_AI table the most relevant for performance data."}
2025-05-01 12:19:45,775 - INFO - User query: Give me best oee, Intent: {'tables': ['OEESHIFTWISE_AI'], 'reason': "The query asks for the 'best oee', which pertains to overall equipment effectiveness (OEE) at a shift level, making the OEESHIFTWISE_AI table the most relevant for performance data."}
2025-05-01 12:19:46,389 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-05-01 12:19:46,396 - INFO - Generated 1 embeddings
2025-05-01 12:19:50,344 - INFO - Retrieved 3 relevant contexts for query: Give me best oee...
2025-05-01 12:19:54,883 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 12:19:54,886 - INFO - RAG response for query 'Give me best oee': To find the best Overall Equipment Effectiveness (OEE) from the `OEESHIFTWISE_AI` table, considering...
2025-05-01 12:19:56,228 - INFO - Executed and cached query: SELECT MAX(CAST(OEE AS FLOAT)) AS Best_OEE
FROM O3_AI_DB.O3_AI_DB_SCHEMA.OEESHIFTWISE_AI AS oee
INNER JOIN O3_AI_DB.O3_AI_DB_SCHEMA.MACHINE_ACCESS_INFO_AI AS machine_access 
    ON oee.PUID = machine_access.PUID
WHERE machine_access.USER_CODE = 'None' 
  AND machine_access.PLANTCODE = 'None';
2025-05-01 12:19:57,859 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 12:19:57,862 - INFO - NLP summary generated: The query aimed to find the best Overall Equipment...
2025-05-01 12:19:59,875 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 12:19:59,885 - INFO - Visualization type determined: none
2025-05-01 12:26:56,650 - INFO - closed
2025-05-01 12:26:56,650 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:27:15,670 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-05-01 12:27:15,670 - INFO - User authenticated: None, Plant: None
2025-05-01 12:27:16,067 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:27:16,067 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:27:16,067 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:27:16,561 - INFO - Snowflake connection initialized
2025-05-01 12:27:18,114 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 12:27:18,370 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 12:27:18,621 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 12:27:18,696 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:27:18,697 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:27:18,697 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:27:18,940 - INFO - Snowflake connection initialized
2025-05-01 12:27:22,623 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 12:27:22,623 - INFO - closed
2025-05-01 12:27:22,687 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:27:22,817 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:27:22,817 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:27:22,817 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:27:23,081 - INFO - Snowflake connection initialized
2025-05-01 12:27:26,924 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 12:27:26,924 - INFO - closed
2025-05-01 12:27:26,980 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:27:27,091 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:27:27,091 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:27:27,091 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:27:27,396 - INFO - Snowflake connection initialized
2025-05-01 12:28:25,642 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 12:28:25,649 - INFO - closed
2025-05-01 12:28:25,704 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:28:38,612 - ERROR - Error decoding JWT token: Invalid token type. Token must be a <class 'bytes'>
2025-05-01 12:28:38,612 - INFO - User authenticated: None, Plant: None
2025-05-01 12:28:38,871 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 12:28:39,157 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 12:28:39,419 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 12:28:39,467 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:28:39,467 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:28:39,467 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:28:40,682 - INFO - Snowflake connection initialized
2025-05-01 12:28:44,691 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 12:28:44,691 - INFO - closed
2025-05-01 12:28:44,747 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:28:44,858 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:28:44,858 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:28:44,858 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:28:45,115 - INFO - Snowflake connection initialized
2025-05-01 12:28:49,214 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 12:28:49,214 - INFO - closed
2025-05-01 12:28:49,277 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:28:49,388 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:28:49,388 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:28:49,388 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:28:49,645 - INFO - Snowflake connection initialized
2025-05-01 12:29:47,841 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 12:29:47,848 - INFO - closed
2025-05-01 12:29:47,924 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:30:07,402 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 12:30:07,443 - INFO - Inferred intent: {'tables': ['OEESHIFTWISE_AI'], 'reason': 'The query asks for the maximum OEE (Overall Equipment Effectiveness) specific to February 2024, which relates directly to shift-level performance data contained in the OEESHIFTWISE_AI table.'}
2025-05-01 12:30:07,443 - INFO - User query: what is max oee for feb 2024, Intent: {'tables': ['OEESHIFTWISE_AI'], 'reason': 'The query asks for the maximum OEE (Overall Equipment Effectiveness) specific to February 2024, which relates directly to shift-level performance data contained in the OEESHIFTWISE_AI table.'}
2025-05-01 12:30:08,501 - INFO - HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
2025-05-01 12:30:08,501 - INFO - Generated 1 embeddings
2025-05-01 12:30:13,084 - INFO - Retrieved 3 relevant contexts for query: what is max oee for feb 2024...
2025-05-01 12:30:14,150 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 12:30:14,156 - INFO - RAG response for query 'what is max oee for feb 2024': You don't have access to this data. Please verify your credentials....
2025-05-01 12:43:08,694 - INFO - Decoded token: {'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier': 'cced8650-8230-4d86-95e3-c9be7b352632', 'userName': 'Admin2', 'plantCode': 'O-2372838648201', 'groupCode': 'S-8656208224193', 'userCode': 'A-1704902113649', 'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress': 'usmansharif994@gmail.com', 'http://schemas.microsoft.com/ws/2008/06/identity/claims/role': ['OFC-DT config', 'KPI Data Refresh', 'Operator', 'TDC Analysis', 'Quality Checklist', 'PRODUCTION MANAGER', 'Admin', 'Autonomous Maintenance', 'Line Leader', 'Admin-user-details-screen', 'Advance Analytics', 'AM New Dashboards', 'QC officer ', 'Analytical Tool', 'COE dashboard', 'QC leader', 'Progressive Maintenance Admin', 'Asset & DMS - Admin2', 'Section Manager', 'Quality Management'], 'exp': 1746123545, 'iss': 'https://localhost:7048/', 'aud': 'https://localhost:4200/'}
2025-05-01 12:43:08,694 - INFO - Extracted user_code: A-1704902113649, plant_code: O-2372838648201
2025-05-01 12:43:08,694 - INFO - User authenticated: A-1704902113649, Plant: O-2372838648201
2025-05-01 12:43:09,797 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 12:43:10,034 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 12:43:10,240 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 12:43:10,286 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:43:10,286 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:43:10,286 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:43:10,672 - INFO - Snowflake connection initialized
2025-05-01 12:43:14,493 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 12:43:14,493 - INFO - closed
2025-05-01 12:43:14,547 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:43:14,658 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:43:14,658 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:43:14,658 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:43:14,921 - INFO - Snowflake connection initialized
2025-05-01 12:43:18,471 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 12:43:18,473 - INFO - closed
2025-05-01 12:43:18,519 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:43:18,623 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:43:18,623 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:43:18,623 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:43:18,883 - INFO - Snowflake connection initialized
2025-05-01 12:44:15,248 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 12:44:15,248 - INFO - closed
2025-05-01 12:44:15,300 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:44:25,486 - INFO - User query: what is max oee for feb 2024, Intent: {'tables': ['OEESHIFTWISE_AI'], 'reason': 'The query asks for the maximum OEE (Overall Equipment Effectiveness) specific to February 2024, which relates directly to shift-level performance data contained in the OEESHIFTWISE_AI table.'}
2025-05-01 12:44:29,742 - INFO - Retrieved 3 relevant contexts for query: what is max oee for feb 2024...
2025-05-01 12:44:33,780 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 12:44:33,780 - INFO - RAG response for query 'what is max oee for feb 2024': To obtain the maximum OEE for February 2024, I will construct a SQL query that filters the data to t...
2025-05-01 12:44:33,962 - ERROR - Query execution error: 000904 (42000): 01bc0d70-0000-85ac-0000-74fd00a53d26: SQL compilation error: error line 9 at position 6
invalid identifier 'MACHINE_ACCESS_INFO_AI.USER_CODE' - Query: SELECT 
    MAX(OEE) AS Max_OEE
FROM 
    O3_AI_DB.O3_AI_DB_SCHEMA.OEESHIFTWISE_AI AS oee
JOIN 
    O3_AI_DB.O3_AI_DB_SCHEMA.MACHINE_ACCESS_INFO_AI AS access
ON 
    oee.PUID = access.PUID
WHERE machine_access_info_ai.user_code='A-1704902113649' AND machine_access_info_ai.Plantcode='O-2372838648201' AND  
    access.USER_CODE = 'A-1704902113649' 
    AND access.PLANTCODE = 'O-2372838648201'
    AND oee.DATE >= '2024-02-01' 
    AND oee.DATE < '2024-03-01';
2025-05-01 12:46:57,272 - INFO - Decoded token: {'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier': 'cced8650-8230-4d86-95e3-c9be7b352632', 'userName': 'Admin2', 'plantCode': 'O-2372838648201', 'groupCode': 'S-8656208224193', 'userCode': 'A-1704902113649', 'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress': 'usmansharif994@gmail.com', 'http://schemas.microsoft.com/ws/2008/06/identity/claims/role': ['OFC-DT config', 'KPI Data Refresh', 'Operator', 'TDC Analysis', 'Quality Checklist', 'PRODUCTION MANAGER', 'Admin', 'Autonomous Maintenance', 'Line Leader', 'Admin-user-details-screen', 'Advance Analytics', 'AM New Dashboards', 'QC officer ', 'Analytical Tool', 'COE dashboard', 'QC leader', 'Progressive Maintenance Admin', 'Asset & DMS - Admin2', 'Section Manager', 'Quality Management'], 'exp': 1746123545, 'iss': 'https://localhost:7048/', 'aud': 'https://localhost:4200/'}
2025-05-01 12:46:57,272 - INFO - Extracted user_code: A-1704902113649, plant_code: O-2372838648201
2025-05-01 12:46:57,272 - INFO - User authenticated: A-1704902113649, Plant: O-2372838648201
2025-05-01 12:46:58,123 - INFO - Executed and cached query: SELECT * FROM OEESHIFTWISE_AI limit 1000
2025-05-01 12:46:58,348 - INFO - Executed and cached query: SELECT * FROM OEEBREAKDOWNAI limit 1000
2025-05-01 12:46:58,573 - INFO - Executed and cached query: SELECT * FROM MACHINE_ACCESS_INFO_AI limit 1000
2025-05-01 12:46:58,619 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:46:58,619 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:46:58,619 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:46:59,066 - INFO - Snowflake connection initialized
2025-05-01 12:47:02,805 - INFO - Loaded 205 embeddings from Snowflake for OEESHIFTWISE_AI
2025-05-01 12:47:02,805 - INFO - closed
2025-05-01 12:47:02,860 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:47:02,969 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:47:02,969 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:47:02,969 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:47:03,271 - INFO - Snowflake connection initialized
2025-05-01 12:47:07,021 - INFO - Loaded 203 embeddings from Snowflake for OEEBREAKDOWNAI
2025-05-01 12:47:07,021 - INFO - closed
2025-05-01 12:47:07,086 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:47:07,184 - INFO - Snowflake Connector for Python Version: 3.14.0, Python Version: 3.12.6, Platform: Windows-11-10.0.26100-SP0
2025-05-01 12:47:07,184 - INFO - Connecting to GLOBAL Snowflake domain
2025-05-01 12:47:07,184 - INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
2025-05-01 12:47:07,454 - INFO - Snowflake connection initialized
2025-05-01 12:48:05,985 - INFO - Loaded 3600 embeddings from Snowflake for MACHINE_ACCESS_INFO_AI
2025-05-01 12:48:05,985 - INFO - closed
2025-05-01 12:48:06,056 - INFO - No async queries seem to be running, deleting session
2025-05-01 12:48:16,607 - INFO - User query: what is max oee for feb 2024, Intent: {'tables': ['OEESHIFTWISE_AI'], 'reason': 'The query asks for the maximum OEE (Overall Equipment Effectiveness) specific to February 2024, which relates directly to shift-level performance data contained in the OEESHIFTWISE_AI table.'}
2025-05-01 12:48:21,166 - INFO - Retrieved 3 relevant contexts for query: what is max oee for feb 2024...
2025-05-01 12:48:24,930 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 12:48:24,946 - INFO - RAG response for query 'what is max oee for feb 2024': To find the maximum OEE for February 2024, you can use the following SQL query, which filters data b...
2025-05-01 12:48:25,219 - INFO - Executed and cached query: SELECT MAX(OEE) AS max_oee
FROM OEESHIFTWISE_AI
INNER JOIN MACHINE_ACCESS_INFO_AI ON OEESHIFTWISE_AI.PUID = MACHINE_ACCESS_INFO_AI.PUID
WHERE MACHINE_ACCESS_INFO_AI.USER_CODE = 'A-1704902113649' 
  AND MACHINE_ACCESS_INFO_AI.PLANTCODE = 'O-2372838648201'
  AND OEESHIFTWISE_AI.DATE >= '2024-02-01' 
  AND OEESHIFTWISE_AI.DATE < '2024-03-01';
2025-05-01 12:48:26,475 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 12:48:26,479 - INFO - NLP summary generated: The maximum OEE (Overall Equipment Efficiency) for...
2025-05-01 12:48:28,671 - INFO - HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
2025-05-01 12:48:28,687 - INFO - Visualization type determined: none
